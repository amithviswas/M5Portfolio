
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Base M5 CSL Palette - Focused on Dark Tech & Precision */
    --background: 0 0% 2%; /* Jet Black Matte */
    --foreground: 0 0% 95%; /* Ice-White LED-like text */

    --card: 210 6% 7%; /* Dark Gunmetal Grey - for primary card/panel backgrounds */
    --card-foreground: 0 0% 90%;

    --popover: 220 8% 6%; /* Darker popover for depth */
    --popover-foreground: 0 0% 90%;

    --primary: 0 100% 50%; /* Blood Red Accent - for key actions, highlights */
    --primary-foreground: 0 0% 98%; /* Text on primary elements */

    --secondary: 220 8% 10%; /* Darker secondary elements */
    --secondary-foreground: 0 0% 70%; /* Muted text on secondary */

    --muted: 220 8% 15%; /* Background for less prominent elements */
    --muted-foreground: 0 0% 50%; /* Text for muted elements */

    --accent: 210 100% 50%; /* Saturated M Blue - for secondary accents, highlights */
    --accent-foreground: 0 0% 98%; /* Text on accent elements */

    --destructive: 0 72% 51%; /* Destructive action color */
    --destructive-foreground: 0 0% 98%;

    --border: 210 6% 12%; /* Graphite Grey for borders - subtle separation */
    --input: 220 8% 8%; /* Dark input backgrounds */
    --ring: 210 100% 55%; /* M Blue for focus rings - consistent with accent */

    --radius: 0.3rem; /* Sharper, more "milled" corners from Aggressive Elegance */

    /* M-Specific & Theme Colors (ensure consistency) */
    --bmw-m-blue: 210 100% 50%;
    --blood-red: 0 100% 50%;
    --m-violet-hsl: 270 100% 65%; /* For M-stripe effects */
    --uv-blue: 220 100% 60%; /* For specific neon glows */
    --gunmetal-silver: 210 10% 45%; /* For metallic accents */
    --m-light-blue-hsl: 210 100% 65%; /* Part of M-stripe */
    --m-red-hsl: 0 100% 50%; /* Part of M-stripe */
    
    /* Transition Easing */
    --ease-m-throttle: cubic-bezier(.36,1.08,.33,1); /* Throttle blip */

    /* Empire Edition Hero Specific */
    --empire-royal-blue-hsl: 210 80% 35%; /* Darker, desaturated M Blue */
    --empire-crimson-hsl: 0 70% 30%;    /* Darker, desaturated M Red */
    --empire-gold-hsl: 45 100% 45%;      /* Muted gold for accents */
    --empire-i-blue-fog-start-hsl: 210 70% 20%; /* For radial fog */
    --empire-text-shadow: 0 1px 1px rgba(0,0,0,0.6), 0 0 5px rgba(0,0,0,0.2), 0 1px 2px rgba(255,255,255,0.1) inset;
    --medallion-nightfall-gradient: conic-gradient(
      from 0deg,
      hsla(210, 100%, 50%, 0.7) 0%, /* M Blue */
      hsla(270, 100%, 65%, 0.7) 33.33%, /* M Violet */
      hsla(0, 100%, 50%, 0.7) 66.67%, /* M Red */
      hsla(210, 100%, 50%, 0.7) 100% /* M Blue */
    );
  }

  :root {
    --background: 0 0% 2%;
    --foreground: 0 0% 95%;
    --card: 210 6% 7%;
    --card-foreground: 0 0% 90%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  html {
    scroll-behavior: smooth;
  }
  body {
    @apply bg-background text-foreground font-sans antialiased;
    background-image:
      linear-gradient(45deg, hsla(var(--card), 0.02) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.02) 75%, hsla(var(--card), 0.02)),
      linear-gradient(-45deg, hsla(var(--card), 0.02) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.02) 75%, hsla(var(--card), 0.02));
    background-size: 4px 4px;
  }

  .font-heading {
    font-family: var(--font-rajdhani);
    letter-spacing: 0.02em; 
    @apply font-bold uppercase;
  }
  
  .font-monospace-subheader {
    font-family: 'Orbitron', 'Exo 2', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    @apply uppercase tracking-wider text-xs font-medium text-muted-foreground;
  }

  /* Specific Hero Fonts - ensure these variables are correctly set by next/font */
  .font-fraunces { font-family: var(--font-fraunces); }
  .font-inter { font-family: var(--font-inter); }
  .font-playfair-display { font-family: var(--font-playfair-display); }
  .font-space-grotesk { font-family: var(--font-space-grotesk); }

  /* Global Transition Utility */
  .transition-m-throttle {
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
    transition-timing-function: var(--ease-m-throttle);
    transition-duration: 150ms; /* Default duration, can be overridden by specific utilities like duration-400 if applied directly in JSX */
  }

  /* Card Styling - Base for M-Performance look */
  .card-m-glow {
    @apply shadow-lg transition-m-throttle;
    box-shadow: 0 8px 20px -8px hsl(var(--background)/0.95),
                0 0 18px -8px hsla(var(--primary)/0.50),
                0 0 15px -8px hsla(var(--bmw-m-blue)/0.40);
  }
  .card-m-glow:hover {
    @apply shadow-[0_15px_35px_-15px_hsl(var(--background)/0.98),_0_0_25px_-6px_hsla(var(--primary)/0.75),_0_0_20px_-6px_hsla(var(--bmw-m-blue)/0.65)];
    transform: translateY(-6px);
  }
  .card-m-glow:hover .card-text-skew { /* Optional text skew on card hover */
    transform: skewX(1deg);
  }

  /* Navbar Underline - M-Stripe Laser Sweep */
  .nav-laser-crest {
    @apply relative text-muted-foreground hover:text-primary-foreground transition-m-throttle;
  }
  .nav-laser-crest::after {
    content: '';
    @apply absolute left-1/2 h-[3px] opacity-0 transition-all duration-200 ease-m-throttle;
    bottom: -4px;
    width: 0%;
    border-radius: var(--radius);
    transform: translateX(-50%);
    background: linear-gradient(90deg, hsl(var(--m-light-blue-hsl)) 0%, hsl(var(--m-violet-hsl)) 33%, hsl(var(--m-red-hsl)) 66%, hsl(var(--m-light-blue-hsl)) 100%);
    background-size: 300% 100%;
    animation: navMStripeAnimation 1s linear infinite paused;
    box-shadow: 0 0 6px hsl(var(--m-light-blue-hsl)/0), 0 0 10px hsl(var(--m-red-hsl)/0);
  }
  .nav-laser-crest:hover::after,
  .nav-laser-crest.active-link::after {
    width: 100%;
    opacity: 1;
    animation-play-state: running;
    box-shadow: 0 0 8px hsl(var(--m-light-blue-hsl)/0.8), 0 0 12px hsl(var(--m-red-hsl)/0.8);
  }
  .nav-laser-crest.active-link {
    @apply text-primary;
    text-shadow: 0 0 8px hsl(var(--primary)/0.6);
  }

  /* Carbon Texture Panel for Cards */
  .carbon-texture-panel {
    background-color: hsl(var(--card));
    background-image: 
      linear-gradient(135deg, hsla(0,0%,0%,.12) 25%, transparent 25%), 
      linear-gradient(225deg, hsla(0,0%,0%,.12) 25%, transparent 25%),
      linear-gradient(45deg, hsla(0,0%,0%,.12) 25%, transparent 25%),
      linear-gradient(315deg, hsla(0,0%,0%,.12) 25%, transparent 25%);
    background-position: 1.5px 0, 1.5px 0, 0 0, 0 0;
    background-size: 3px 3px; /* Finer CSL weave */
    background-repeat: repeat;
    border: 1px solid hsl(var(--border));
    border-radius: var(--radius);
  }

  /* Neon Edge Lights Utilities */
  .neon-edge-white {
    box-shadow: 0 0 2px hsl(var(--foreground)), 0 0 4px hsla(var(--foreground)/0.6), 0 0 6px hsla(var(--foreground)/0.4);
  }
  .neon-edge-primary {
    box-shadow: 0 0 3px hsl(var(--primary)), 0 0 5px hsl(var(--primary)/0.7), 0 0 7px hsl(var(--primary)/0.5);
  }
  .neon-edge-accent {
     box-shadow: 0 0 3px hsl(var(--accent)), 0 0 5px hsl(var(--accent)/0.7), 0 0 7px hsl(var(--accent)/0.5);
  }

  /* Glowing Red Seal Stamp for Cards */
  .card-with-glowing-seal::before {
    content: '';
    @apply absolute top-1.5 right-1.5 w-2 h-2 rounded-full bg-primary opacity-0 transition-opacity duration-300 ease-m-throttle;
    box-shadow: 0 0 6px 2px hsl(var(--primary)/0.7);
  }
  .card-with-glowing-seal:hover::before {
    opacity: 1;
  }
  
  /* Click Ripple Effect */
  .click-ripple-effect {
    @apply relative overflow-hidden;
  }
  .click-ripple-effect::after { /* This is for the ripple itself */
    content: "";
    @apply absolute block bg-white opacity-40 rounded-full pointer-events-none;
    transform: scale(10, 10);
    opacity: 0;
    transition: transform .3s ease-out, opacity .3s ease-out;
  }
  .click-ripple-effect.rippling::after { /* Class added by JS on click */
    transform: scale(0,0);
    opacity: 0.3;
    animation: clickRipple 0.6s linear;
  }

  /* MStartStopButton Hover Ring Enhancement */
  /* This class is applied on the MStartStopButton directly */
  .MStartStopButton-base-style::before { 
    content: '';
    position: absolute;
    inset: -1.5px; 
    border-radius: var(--radius); 
    opacity: 0;
    transition: opacity 0.25s ease-in-out, box-shadow 0.25s ease-in-out; 
    background: transparent; 
    pointer-events: none; 
    z-index: -1; 
  }
  /* This targets the ::before pseudo-element when the parent with group class is hovered */
  .group:hover .MStartStopButton-base-style::before {
      opacity: 1;
      box-shadow: 0 0 0 0.5px hsl(var(--foreground)),
                  0 0 0 2px hsl(var(--primary)),
                  0 0 0 3.5px hsl(var(--bmw-m-blue)/0.8),
                  0 0 20px 4px hsl(var(--primary)/0.6);
  }


  /* Footer Diffuser */
  .carbon-wave-animated::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: 
      linear-gradient(45deg, hsla(var(--card), 0.03) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.03) 75%, hsla(var(--card), 0.03)),
      linear-gradient(-45deg, hsla(var(--card), 0.03) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.03) 75%, hsla(var(--card), 0.03));
    background-size: 5px 5px;
    opacity: 0.3; 
    z-index: 0; 
    animation: carbonWeaveShift 10s linear infinite;
  }
  .footer-diffuser-fin-dot {
    @apply w-1 h-1 rounded-full bg-primary shadow-[0_0_5px_1.5px_hsl(var(--primary)/0.6)];
    animation: pulseDot 3s infinite ease-in-out;
  }

  /* Section Grille-Blade Frames */
  .section-grille-blade {
    @apply absolute w-[1.5px] bg-gradient-to-b from-neutral-700/80 via-neutral-600/80 to-neutral-700/80 shadow-md;
  }
  
  /* Crystal HUD Tooltips */
  .crystal-hud-tooltip-content {
    @apply bg-black/80 backdrop-blur-md border-gradient-m-blue-red p-0 shadow-xl;
    clip-path: polygon(0% 8%, 8% 0%, 92% 0%, 100% 8%, 100% 92%, 92% 100%, 8% 100%, 0% 92%);
  }
  .crystal-hud-tooltip-content .tooltip-inner-padding { 
     @apply p-1 px-2 text-[11px] text-primary-foreground;
  }
  .border-gradient-m-blue-red { 
    border: 1px solid transparent;
    background-clip: padding-box, border-box;
    background-origin: padding-box, border-box;
    background-image: linear-gradient(to right, hsl(var(--background)), hsl(var(--background))), 
                      linear-gradient(135deg, hsl(var(--bmw-m-blue)), hsl(var(--primary)));
  }

  /* Dynamic Headlight Sweep Background (Hero) */
  .hero-headlight-sweep-bg {
    @apply fixed -z-10 opacity-[0.04] mix-blend-screen;
    top: -25%; left: -45%; width: 190vw; height: 190vh;
    background: radial-gradient(ellipse at center, hsla(var(--accent), 0.35) 0%, transparent 55%);
    transform-origin: center center;
    animation: headlightSweep 20s infinite alternate ease-in-out;
  }
  
  /* === HERO MEDALLION STYLES (Empire Edition Base) === */
  .hero-medallion-empire {
    @apply relative inline-block p-0.5 rounded-full shadow-xl transition-transform duration-300 ease-m-throttle;
    background: radial-gradient(circle, hsl(var(--card)) 45%, transparent 70%), 
                linear-gradient(135deg, hsl(var(--border)) 0%, hsl(var(--background)) 50%, hsl(var(--border)) 100%); 
    border: 1px solid hsl(var(--border)/0.7);
  }
  .hero-medallion-empire:hover {
    transform: scale(1.03) translateY(-3px); /* Adjusted hover for aggression */
  }
  .hero-medallion-empire::before { /* Darker, more subtle pulse for CSL Empire */
    content: '';
    @apply absolute inset-[-3px] rounded-full -z-10;
    background: conic-gradient(
      from 0deg,
      hsla(var(--border), 0.3) 0deg 90deg,          /* Dark Graphite, less opaque */
      hsla(var(--empire-royal-blue-hsl), 0.2) 90deg 180deg, /* Dark Desat. M Blue, less opaque */
      hsla(var(--border), 0.3) 180deg 270deg,       /* Dark Graphite, less opaque */
      hsla(var(--empire-crimson-hsl), 0.15) 270deg 360deg    /* Dark Desat. M Red, less opaque */
    );
    animation: empireMedallionPulse 2.5s infinite linear; /* Slightly faster pulse */ 
    box-shadow: 0 0 8px 0.5px hsla(var(--uv-blue),.10), 0 0 4px 0 hsla(var(--primary)/.05) inset; 
  }
  .hero-medallion-empire .spec-highlight-arc { /* Lacquer highlight */
    @apply absolute inset-0 rounded-full;
    background: linear-gradient(135deg, hsla(0,0%,100%,.05) 0%, transparent 50%); 
  }

  /* --- HERO MEDALLION NIGHTFALL (For new theme) --- */
  .hero-medallion-nightfall-inner {
    @apply relative w-full h-full rounded-full overflow-hidden;
    /* background: radial-gradient(circle, hsl(var(--card) / 0.7) 50%, hsl(var(--card)) 100%); */
    box-shadow: inset 0 0 10px hsla(0,0%,0%,0.5), 0 0 5px hsla(var(--uv-blue),0.2);
  }
  .hero-medallion-nightfall-inner::before { /* Conic gradient ring */
    content: "";
    @apply absolute inset-[-3px] rounded-full -z-10;
    /* Conic gradient for the M-stripe pulse */
    background: var(--medallion-nightfall-gradient); /* Using CSS variable */
    animation: nightfallMedallionSpin 5s linear infinite, nightfallMedallionPulse 2s infinite ease-in-out;
    box-shadow: 0 0 15px 2px hsla(var(--uv-blue), 0.3), 0 0 5px hsla(var(--primary), 0.2);
  }
  .hero-medallion-nightfall-inner:hover::before {
    animation-play-state: paused, running; /* Pause spin, keep pulse */
    filter: brightness(1.2);
  }
  /* End Hero Medallion Nightfall */


  .hero-headline-empire { 
    font-family: var(--font-fraunces); 
    @apply text-[#E5E5E5]; 
    text-shadow: var(--empire-text-shadow); 
  }
  .hero-tagline-empire { 
    font-family: var(--font-space-grotesk); 
    @apply text-transparent bg-clip-text bg-gradient-to-r from-[hsl(var(--bmw-m-blue))] to-[hsl(var(--primary))] relative;
  }
  .hero-tagline-empire::after { /* Grille-blade underline */
    content: '';
    @apply absolute left-0 -bottom-1 h-[1.5px] bg-gradient-to-r from-[hsl(var(--bmw-m-blue))] to-[hsl(var(--primary))];
    width: 0%; 
    border-radius: var(--radius);
    transition: width 0.4s var(--ease-m-throttle); 
  }
  .hero-tagline-empire.underline-visible::after {
    width: 105%;
  }
  .hero-empire-bg { /* Background for "Empire" hero variant */
    @apply relative overflow-hidden; 
    background-image: 
      radial-gradient(ellipse at 50% 15%, hsla(var(--empire-i-blue-fog-start-hsl), 0.1) 0%, transparent 55%), /* More subtle fog */
      linear-gradient(45deg, hsla(var(--card), 0.01) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.01) 75%, hsla(var(--card), 0.01)), 
      linear-gradient(-45deg, hsla(var(--card), 0.01) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.01) 75%, hsla(var(--card), 0.01)),
      radial-gradient(circle at 35% 35%, #1a1a1c 0%, hsl(var(--background)) 60%); /* Darker base */
    background-size: cover, 4px 4px, 4px 4px, cover; /* Finer carbon */
  }
  
  /* Halo glows & Gantry lights (Empire) */
  .halo-glow { 
    @apply absolute rounded-full mix-blend-soft-light pointer-events-none -z-[5];
    animation: bloomGlide 18s infinite alternate ease-in-out;
  }
  .hero-bloom-extra {
    @apply absolute -z-[6];
    width: 400px; height: 400px; top: 50%; left: 50%;
    background: radial-gradient(circle, hsla(var(--m-violet-hsl), 0.05) 0%, transparent 60%);
    animation: bloomGlide 20s infinite alternate ease-in-out 1.5s;
  }
  .hero-empire-tachometer { /* Scroll RPM Bar Styling */
    @apply fixed bottom-3 right-3 w-14 h-7 rounded-sm p-0.5 overflow-hidden;
    background: linear-gradient(135deg, hsl(var(--card) / 0.7), hsl(var(--background) / 0.7));
    backdrop-filter: blur(4px);
    border: 0.5px solid hsl(var(--border) / 0.4);
    box-shadow: 0 0 8px hsl(var(--accent)/0.15), inset 0 0.5px 0.5px hsl(var(--foreground)/0.05);
    border-radius: var(--radius);
  }
  .hero-empire-tachometer-bar {
    @apply h-full rounded-sm transition-all duration-200 ease-linear;
  }
   .hero-empire-tachometer-trail {
    @apply absolute top-0 left-0 h-full w-full rounded-sm opacity-0 blur-sm transition-opacity duration-400;
    background: inherit; /* Will pick up parent's gradient slice */
    border-radius: var(--radius);
  }
  .hero-gantry-light {
    @apply absolute left-0 w-full h-[1.5px] opacity-0;
    background: linear-gradient(90deg, transparent, hsl(var(--accent)/0.4) 50%, transparent);
    box-shadow: 0 0 4px 0.5px hsl(var(--accent)/0.25);
  }

  /* Nano Particle Shimmer & Lens Flares (for Nightfall Atelier theme) */
  .nano-particle-shimmer {
    @apply absolute inset-0 overflow-hidden pointer-events-none -z-[4]; /* Ensure it's behind content but above base bg */
  }
  .nano-particle {
    @apply absolute rounded-full bg-white opacity-0;
    animation: nanoDriftAndFade 8s infinite ease-in-out;
  }
  .vertical-lens-flare {
    @apply absolute top-0 w-[1px] h-[150%] pointer-events-none opacity-0 -z-[3];
    background: linear-gradient(to bottom, transparent, hsla(var(--uv-blue),0.4) 40%, hsla(var(--uv-blue),0.6) 50%, hsla(var(--uv-blue),0.4) 60%, transparent);
    filter: blur(0.5px);
    animation: verticalFlareSweep 10s infinite ease-in-out;
  }
  /* End Nano Particle Shimmer & Lens Flares */

  /* === HUD STYLES (Aggressive Elegance / XENOFRAME base) === */
  .hud-console-panel {
    @apply fixed bottom-3 left-3 p-2 md:p-2.5 rounded-md shadow-2xl text-[11px] backdrop-blur-lg border border-neutral-700/50;
    background-color: hsla(var(--background), 0.85); 
    color: hsl(var(--foreground)); 
    font-family: var(--font-monospace-subheader); 
    width: 250px; 
    max-height: 250px; 
    display: flex;
    flex-direction: column;
    gap: 1.5px; 
    box-shadow: 0 0 15px hsl(var(--uv-blue)/0.25), 0 0 5px hsl(var(--uv-blue)/0.1) inset;
    transition: box-shadow 0.25s var(--ease-m-throttle);
    border-radius: var(--radius);
  }
  .hud-console-panel.uv-glow { /* Active UV Glow for Ghostline or XENOFRAME */
    box-shadow: 0 0 22px 4px hsl(var(--uv-blue)/0.45), 0 0 10px 2.5px hsl(var(--uv-blue)/0.2) inset, 0 0 5px 1px hsl(var(--primary)/0.2);
  }
  .hud-console-header {
    @apply flex justify-between items-center pb-0.5 mb-0.5 border-b border-neutral-700/70;
  }
  .hud-console-title {
    @apply text-[11px] font-bold uppercase tracking-wider text-primary-foreground font-heading;
  }
  .hud-console-settings-icon {
    @apply text-neutral-400 hover:text-primary transition-m-throttle;
    animation: spin 3s linear infinite; /* Correct usage of Tailwind's spin */
  }
  .hud-console-log { 
    @apply flex-grow overflow-y-auto text-[9px] leading-snug p-0.5 bg-black/35 rounded-sm min-h-[35px];
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary)) hsl(var(--background)); 
  }
  .hud-console-log .console-log-line { @apply mb-0.5; } 
  .hud-console-log .console-log-line.input::before { content: '> SYS_CMD: '; @apply text-accent; } 
  .hud-console-log .console-log-line.output { @apply text-green-400; }
  .hud-console-log .console-log-line.error { @apply text-red-400; }
  .hud-console-log .console-log-line.info { @apply text-sky-400; }
  .hud-console-log .console-log-line.system { @apply text-purple-400 italic; } 
  .hud-console-log .typewriter-cursor {
    @apply inline-block bg-primary w-1 h-2 ml-0.5 animate-pulse;
  }
  .hud-gauge-item {
    @apply flex justify-between items-center text-[9px] py-0;
  }
  .hud-gauge-label { 
    @apply flex items-center gap-0.5 text-neutral-500 uppercase tracking-wider font-monospace-subheader;
  }
  .hud-gauge-label svg { @apply w-2 h-2 text-accent; }
  .hud-gauge-value {
    @apply font-mono text-neutral-400 font-medium;
  }
  .hud-meter-track {
    @apply h-0.5 w-full bg-neutral-700/60 rounded-full overflow-hidden my-0.5;
  }
  .hud-meter-fill { 
    @apply h-full rounded-full transition-all duration-250 ease-linear;
    box-shadow: inset 0 0 1.5px hsl(var(--background)/0.5);
  }
  .hud-console-button-container {
    @apply grid grid-cols-2 gap-0.5 pt-0.5 mt-0.5 border-t border-neutral-700/70;
  }
  .hud-console-button { 
    @apply !w-full !h-6 !text-[8px] !tracking-normal !border-neutral-600/70;
  }
  .hud-console-button.active-toggle { 
    @apply !bg-gradient-to-r !from-accent !to-sky-500 !text-primary-foreground !border-accent/70 shadow-[0_0_5px_hsl(var(--accent)/0.35)];
  }
  .form-container-halo { 
    transition: box-shadow 0.3s var(--ease-m-throttle);
  }
  .form-container-halo-active { 
    box-shadow: 0 0 18px 3.5px hsl(var(--primary)/0.4), 0 0 6px 1px hsl(var(--primary)/0.2);
  }
  
  /* === SKILL SECTION (Overclocked Skill Flux Engine - Aggressive Elegance / XENOFRAME) === */
  .skill-card-trail-container { 
    @apply relative; 
  }
  .skill-card-trail { /* Base subtle trail */
    @apply absolute inset-0 -z-10 rounded-lg opacity-0 transition-opacity duration-250;
    background: radial-gradient(circle at center, hsl(var(--primary)/0.1) 0%, transparent 70%);
    transform: scale(1.1); 
    filter: blur(5px);
  }
  .skill-card-trail-container:hover .skill-card-trail { /* Standard hover trail */
    opacity: 0.65;
    animation: skillTrailFadeOut 0.4s 0.1s forwards; 
  }
  .skill-card-trail.electric-trail { /* For Overclocked state */
    background: radial-gradient(circle at center, hsl(var(--uv-blue)/0.35) 0%, transparent 50%),
                radial-gradient(circle at center, hsl(var(--primary)/0.2) 0%, transparent 60%);
    filter: blur(3px) brightness(1.35);
    animation: skillFluxPulse 0.4s infinite alternate; 
  }
  .skill-overclocked { /* Applied when skill is "overclocked" */
    animation: skillFluxPulse 0.5s infinite ease-in-out, skillJitter 0.08s infinite alternate ease-in-out;
    border-color: hsl(var(--uv-blue)/0.75) !important;
    box-shadow: 0 0 12px hsl(var(--uv-blue)/0.5), 0 0 6px hsl(var(--primary)/0.3);
  }
  .animate-skill-jitter { /* Generic jitter for hover on all skill cards */
    animation: skillJitter 0.2s infinite alternate ease-in-out;
  }


  /* === SCROLL MOMENTUM BAR / APEX METER (Aggressive Elegance / XENOFRAME) === */
  .m-chrono-scroll-gauge-container { /* Apex Meter - CSL Precision */
    @apply fixed top-2.5 left-2.5 h-6 w-40 bg-neutral-900/70 backdrop-blur-md rounded-sm overflow-hidden shadow-lg border border-neutral-700/50;
    clip-path: polygon(0 0, 100% 0, 100% 100%, 50% 85%, 0 100%); /* Adjusted for Apex Meter */
    box-shadow: 0 0 10px 1px hsl(var(--uv-blue)/0.3), inset 0 0.5px 0.5px hsl(var(--foreground)/0.04), 0 0 3px hsl(var(--background)/0.2) inset;
    border-radius: var(--radius);
  }
  .m-rpm-gauge-fill { /* Base fill style for the bar - CSL Feel */
    @apply h-full transition-all duration-100 ease-linear;
    border-radius: var(--radius);
    box-shadow: inset 0 0 5px hsl(var(--background)/0.5), 0 0 6px hsl(var(--primary)/0.4); 
  }
  .m-rpm-gauge-fill-xenoflame { /* Specific gradient for Apex Meter (iBlue -> Hyper Violet -> Voltage Gold/Red) - CSL Intensity */
    background-image: linear-gradient(to right, hsl(var(--bmw-m-blue)) 0%, hsl(var(--m-violet-hsl)) 50%, hsl(var(--primary)) 100%); 
    box-shadow: inset 0 0 3px hsla(0,0%,0%,0.5), 0 0 5px hsl(var(--m-violet-hsl)/0.5), 0 0 10px hsl(var(--primary)/0.35);
  }
  .m-chrono-tick-container {
    @apply absolute inset-0 flex justify-between px-0.5 items-center pointer-events-none;
  }
  .m-rpm-tick-major, .m-rpm-tick-minor, .m-rpm-tick-redzone {
    @apply h-2/3 opacity-70 transition-opacity duration-250; /* Brighter ticks */
    box-shadow: 0 0 2px hsl(var(--foreground)/0.6), 0 0 0.5px hsl(var(--foreground)/0.8); /* Sharper glow */
  }
  .m-rpm-tick-major { width: 1.5px; background-color: hsl(var(--foreground)/0.8); } /* Slightly thicker major */
  .m-rpm-tick-minor { width: 0.5px; background-color: hsl(var(--foreground)/0.5); }
  .m-rpm-tick-redzone { 
    background-color: hsl(var(--primary)/0.8) !important; 
    box-shadow: 0 0 4px hsl(var(--primary)/0.7), 0 0 1.5px hsl(var(--primary)/0.9); 
  }
  .m-rpm-tick-active { opacity: 1; transform: scaleY(1.1); } /* More pronounced active state */
  .chrono-gauge-redline .m-rpm-gauge-fill { 
    animation: m-rpm-redline-led-pulse 0.08s infinite alternate ease-in-out; /* Faster LED pulse */
  }

  /* === NEUROLINK TERMINAL STYLES (XENOFRAME adapted for Aggressive Elegance) === */
  .neurolink-terminal-overlay {
    @apply fixed inset-0 bg-black/90 backdrop-blur-md z-[200] flex items-center justify-center p-2.5;
    animation: fadeIn 0.25s ease-out;
  }
  .neurolink-terminal {
    @apply bg-neutral-900/90 border border-primary/35 rounded-md shadow-2xl w-full max-w-lg h-[60vh] flex flex-col overflow-hidden;
    box-shadow: 0 0 20px hsl(var(--primary)/0.3);
    animation: slideInFromBottom 0.35s ease-out;
    border-radius: var(--radius);
  }
  .neurolink-terminal-header {
    @apply p-1 bg-neutral-800/85 border-b border-primary/35 text-[11px] text-primary font-mono flex justify-between items-center;
  }
  .neurolink-terminal-output {
    @apply flex-grow p-1.5 overflow-y-auto font-mono text-[11px];
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary)) hsl(var(--background)); /* Use background for track */
  }
  .neurolink-terminal-output div { @apply mb-0.5 whitespace-pre-wrap break-words; } 
  .neurolink-terminal-output .input-line::before { content: 'M_DRIVE:> '; @apply text-accent; } 
  .neurolink-terminal-output .output-line { @apply text-green-400; }
  .neurolink-terminal-output .error-line { @apply text-red-400; }
  .neurolink-terminal-output .info-line { @apply text-sky-400; }
  .neurolink-terminal-input-area {
    @apply p-1 border-t border-primary/35 flex items-center bg-neutral-800/85;
  }
  .neurolink-terminal-prompt { @apply text-accent font-mono text-[11px] mr-1; }
  .neurolink-terminal-input {
    @apply flex-grow bg-transparent border-none outline-none text-primary-foreground font-mono text-[11px] p-0.5;
    text-shadow: 0 0 3px hsl(var(--primary)/0.35);
  }

  /* General Dialog Content Fix for ShadCN */
  .DialogContent[data-state="open"] {
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Important for controlling internal scroll */
  }

  /* Keyframes (Consolidated, updated, and new for Aggressive Elegance / XENOFRAME - "Precision Engineering") */
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes slideInFromBottom { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

  @keyframes spin { to { transform: rotate(360deg); } }
  
  /* Pulse for Empire Medallion (Darker, more subtle) */
  @keyframes empireMedallionPulse {
    0%, 100% { box-shadow: 0 0 8px 0.5px hsla(var(--uv-blue),.10), 0 0 4px 0 hsla(var(--primary)/.05) inset; transform: scale(1); }
    50% { box-shadow: 0 0 12px 1px hsla(var(--uv-blue),.15), 0 0 6px 0.5px hsla(var(--primary)/.08) inset; transform: scale(1.02); }
  }

  @keyframes nightfallMedallionSpin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
  @keyframes nightfallMedallionPulse {
    0%, 100% { box-shadow: 0 0 15px 2px hsla(var(--uv-blue), 0.3), 0 0 5px hsla(var(--primary), 0.2), inset 0 0 8px hsla(var(--uv-blue),0.15); opacity: 0.7; }
    50% { box-shadow: 0 0 25px 4px hsla(var(--uv-blue), 0.5), 0 0 10px hsla(var(--primary), 0.3), inset 0 0 12px hsla(var(--uv-blue),0.25); opacity: 1; }
  }

  @keyframes m-rpm-redline-led-pulse { /* Sharper, more aggressive redline pulse - Aggressive Elegance */
    0%, 100% {
      box-shadow: inset 0 0 8px hsl(var(--background)/0.6), 0 0 30px 10px hsl(var(--primary)/0.95), 0 0 60px 20px hsl(var(--primary)/0.8);
      filter: brightness(3.5) saturate(3.5); 
    }
    50% {
      box-shadow: inset 0 0 12px hsl(var(--background)/0.7), 0 0 40px 15px hsl(var(--primary)/1), 0 0 80px 30px hsl(var(--primary)/0.95);
      filter: brightness(4.5) saturate(4.5); 
    }
  }

  @keyframes carbonWeaveShift { 
    0% { background-position: 0 0; }
    100% { background-position: 5px 5px; } 
  }
  @keyframes pulseDot { 
    0%, 100% { opacity: 0.55; transform: scale(0.85); box-shadow: 0 0 3px hsl(var(--primary)/0.45); }
    50% { opacity: 0.95; transform: scale(1.05); box-shadow: 0 0 7px hsl(var(--primary)/0.9); }
  }

  /* Nav M-Stripe Animation - Aggressive Elegance Laser Sweep */
  @keyframes navMStripeAnimation {
    0% { background-position: 150% 0; } /* Start off-screen, more aggressive sweep */
    100% { background-position: -50% 0; }
  }


  /* Skill Flux Animations - Aggressive Elegance / XENOFRAME Overclocked */
  @keyframes skillFluxPulse { 
    0%, 100% { border-color: hsl(var(--uv-blue)/0.5); box-shadow: 0 0 8px hsl(var(--uv-blue)/0.3), 0 0 4px hsl(var(--primary)/0.2); }
    50% { border-color: hsl(var(--uv-blue)); box-shadow: 0 0 22px hsl(var(--uv-blue)/0.7), 0 0 10px hsl(var(--primary)/0.4), inset 0 0 5px hsl(var(--uv-blue)/0.3); }
  }
  @keyframes skillJitter { 
    0% { transform: translate(0, 0) rotate(0); }
    25% { transform: translate(0.5px, -0.5px) rotate(0.1deg); } 
    50% { transform: translate(-0.5px, 0.5px) rotate(-0.1deg); }
    75% { transform: translate(0.5px, 0.5px) rotate(0.05deg); }
    100% { transform: translate(0, 0) rotate(0); }
  }
  @keyframes skillTrailFadeOut { 
    from { opacity: 0.65; transform: scale(1.1); }
    to { opacity: 0; transform: scale(1.2); filter: blur(7px); } /* More pronounced fade */
  }
  
  @keyframes clickRipple {
    to {
      transform: scale(3.5);
      opacity: 0;
    }
  }

  @keyframes headlightSweep {
    0% { transform: translateX(-5vw) rotate(-12deg); }
    100% { transform: translateX(5vw) rotate(-12deg); }
  }
    
  @keyframes bloomGlide { /* For Hero Background Halos */
    0% { transform: translate(0, 0) scale(1); opacity: 0.05; } 
    50% { transform: translate(10px, 6px) scale(1.06); opacity: 0.08; }
    100% { transform: translate(0, 0) scale(1); opacity: 0.05; }
  }

  @keyframes nanoDriftAndFade {
    0% { transform: translate(0, 0) scale(0.5); opacity: 0; }
    20% { opacity: 0.7; transform: scale(1); }
    80% { opacity: 0.7; transform: scale(1); }
    100% { transform: translate(var(--drift-x, 0px), var(--drift-y, 0px)) scale(0.5); opacity: 0; }
  }
  @keyframes verticalFlareSweep {
    0% { transform: translateY(-100%) scaleY(0.5); opacity: 0; }
    10%, 20% { transform: translateY(0) scaleY(1); opacity: 1; }
    30%, 100% { transform: translateY(100%) scaleY(0.5); opacity: 0; }
  }
  
  /* Rare Section Pulse (Body visual feedback) - Aggressive Elegance */
  @keyframes rareSectionVisualPulse {
    0% { box-shadow: inset 0 0 0 0px hsl(var(--primary)/0); }
    50% { box-shadow: inset 0 0 0 4px hsl(var(--primary)/0.15); } /* More noticeable */
    100% { box-shadow: inset 0 0 0 0px hsl(var(--primary)/0); }
  }
  /* Hyper Scroll Feedback (Body visual feedback) - Aggressive Elegance */
  @keyframes hyperScrollVisualFeedback {
    0% { filter: brightness(1); }
    50% { filter: brightness(0.92) saturate(1.3); } /* More aggressive dim/saturate */
    100% { filter: brightness(1); }
  }
  /* Ghostline Skill Pulse (Feedback) - Aggressive Elegance */
  @keyframes ghostlineSkillPulse {
    0%, 100% { border-color: hsl(var(--uv-blue)/0.75); } /* Brighter base */
    50% { border-color: hsl(var(--uv-blue)/0.35); }
  }
  /* Erratic Glow (Feedback) - Aggressive Elegance */
  @keyframes erraticGlowAnimation {
    0% { box-shadow: 0 0 8px hsl(var(--primary)/0.35), 0 0 4px hsl(var(--accent)/0.15); }
    25% { box-shadow: 0 0 12px hsl(var(--primary)/0.5), 0 0 6px hsl(var(--accent)/0.25), 0 0 4px hsl(var(--uv-blue)/0.15); }
    50% { box-shadow: 0 0 7px hsl(var(--primary)/0.3), 0 0 3px hsl(var(--accent)/0.1); }
    75% { box-shadow: 0 0 15px hsl(var(--primary)/0.6), 0 0 8px hsl(var(--accent)/0.35), 0 0 6px hsl(var(--uv-blue)/0.25); }
    100% { box-shadow: 0 0 8px hsl(var(--primary)/0.35), 0 0 4px hsl(var(--accent)/0.15); }
  }

} /* Base Layer End */

/* Reduced Motion Fallbacks (Aggressive Elegance / XENOFRAME Theme) */
@media (prefers-reduced-motion: reduce) {
  .transition-m-throttle {
    transition: none !important;
  }
  .nav-laser-crest::after { 
    animation: none !important;
    width: 70% !important; /* Static underline width */
    opacity: 0.9 !important;
    background: linear-gradient(90deg, hsl(var(--m-light-blue-hsl)) 0%, hsl(var(--m-violet-hsl)) 50%, hsl(var(--m-red-hsl)) 100%);
    background-size: 100% 100%;
    background-position: center;
  }
  .hud-console-settings-icon { animation: none; } 
  .carbon-wave-animated::before { animation: none !important; } 
  .footer-diffuser-fin-dot { animation: none !important; opacity: 0.6; } 
  .hero-headlight-sweep-bg { animation: none !important; opacity: 0.04 !important; } 
  .chrono-gauge-redline .m-rpm-gauge-fill { animation: none !important; background: hsl(var(--primary)) !important; } 
  .m-rpm-tick-active { transform: scaleY(1); } 
  .halo-glow { animation: none; opacity: 0.06; }  
  .hero-medallion-empire::before {animation: none; box-shadow: 0 0 8px 1px hsla(var(--uv-blue),.10), 0 0 4px 0 hsla(var(--primary)/.05) inset;} 
  .hero-tagline-empire.underline-visible::after { transition: none; width: 100%;} 
  .skill-card-trail-container:hover .skill-card-trail { animation: none; opacity: 0.3; } 
  .skill-overclocked { animation: none !important; border-color: hsl(var(--uv-blue)/0.6) !important; box-shadow: 0 0 9px hsl(var(--uv-blue)/0.4), 0 0 4px hsl(var(--primary)/0.25); }
  .animate-skill-jitter { animation: none; }
  .rare-section-pulse-active body { animation: none; } 
  .hyperactive-scroll-feedback body { animation: none; } 
  .erratic-glow { animation: none; } 
  .neurolink-terminal-overlay { animation: none; } 
  .neurolink-terminal { animation: none; }
  .MStartStopButton-base-style::before { animation: none !important; }
  .group:hover .MStartStopButton-base-style::before { animation: none !important; box-shadow: 0 0 0 0.5px hsl(var(--foreground)), 0 0 0 2px hsl(var(--primary)), 0 0 0 3.5px hsl(var(--bmw-m-blue)/0.8), 0 0 12px 4px hsl(var(--primary)/0.5); }
  .click-ripple-effect.rippling::after { animation: none; display: none; }
  .hero-medallion-nightfall-inner::before { animation: nightfallMedallionPulse 3s infinite ease-in-out; /* Keep pulse, remove spin */ }
  .nano-particle { animation: none; opacity: 0.1; /* Static visible particles */ }
  .vertical-lens-flare { animation: none; opacity: 0.15; /* Static flare */ }
}

    
```