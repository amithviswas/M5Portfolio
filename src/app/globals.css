
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Jet Black & M-Sport CSL Palette */
    --background: 0 0% 2%; /* Jet Black Matte */
    --foreground: 0 0% 95%; /* Ice-White LED-like text */

    --card: 210 6% 7%; /* Dark Gunmetal Grey */
    --card-foreground: 0 0% 90%;

    --popover: 220 8% 6%; /* Slightly darker popover */
    --popover-foreground: 0 0% 90%;

    --primary: 0 100% 50%; /* Blood Red Accent */
    --primary-foreground: 0 0% 98%; /* For text on primary */

    --secondary: 220 8% 10%; /* Darker secondary for subtle elements */
    --secondary-foreground: 0 0% 70%;

    --muted: 220 8% 15%;
    --muted-foreground: 0 0% 50%; /* Softer muted text */

    --accent: 210 100% 50%; /* Saturated M Blue */
    --accent-foreground: 0 0% 98%;

    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 98%;

    --border: 210 6% 12%; /* Graphite Grey for borders */
    --input: 220 8% 8%; /* Darker input fields */
    --ring: 210 100% 55%; /* M Blue for focus rings */

    --radius: 0.1rem; /* Knife-edge angles */

    /* M-Specific & Theme Colors */
    --bmw-m-blue: 210 100% 50%;
    --blood-red: 0 100% 50%;
    --m-violet-hsl: 270 100% 65%;
    --uv-blue: 220 100% 60%; /* UV Blue for neon glows */
    --gunmetal-silver: 210 10% 45%;
    --m-light-blue-hsl: 210 100% 65%; /* For M-Stripe */
    --m-red-hsl: 0 100% 50%; /* For M-Stripe */
    
    /* Empire Edition (kept for ref) */
    --empire-royal-blue-hsl: 220 70% 55%;
    --empire-crimson-hsl: 350 70% 50%;
    --empire-gold-hsl: 45 100% 50%;
    --empire-i-blue-fog-start-hsl: 210 100% 15%;
    --empire-i-blue-fog-end-hsl: 220 10% 7%;


    /* Animation Easing - "Throttle Blip" */
    --ease-m-throttle: cubic-bezier(.36,1.08,.33,1);
    --empire-text-shadow: 0 1px 1px rgba(0,0,0,0.6), 0 0 5px rgba(0,0,0,0.2), 0 1px 2px rgba(255,255,255,0.1) inset;

    --medallion-nightfall-gradient: conic-gradient(
      from 0deg,
      hsla(210, 100%, 50%, 0.7) 0deg,
      hsla(270, 100%, 65%, 0.7) 120deg,
      hsla(0, 100%, 50%, 0.7) 240deg,
      hsla(210, 100%, 50%, 0.7) 360deg
    );
  }

  :root.dark {
    /* Ensure dark theme variables are consistent with the new CSL palette */
    --background: 0 0% 2%;
    --foreground: 0 0% 95%;
    --card: 210 6% 7%;
    --card-foreground: 0 0% 90%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  html {
    scroll-behavior: smooth;
  }
  body {
    @apply bg-background text-foreground font-sans antialiased;
    /* Subtle carbon-fiber weave background for jet-black base */
    background-image:
      linear-gradient(45deg, hsla(var(--card), 0.02) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.02) 75%, hsla(var(--card), 0.02)),
      linear-gradient(-45deg, hsla(var(--card), 0.02) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.02) 75%, hsla(var(--card), 0.02));
    background-size: 3px 3px; /* Finer, more subtle weave */
  }

  .font-heading { /* Rajdhani for headings */
    font-family: var(--font-rajdhani);
    letter-spacing: 0.02em; /* Tight tracking */
    @apply font-bold uppercase;
  }
  .font-monospace-subheader { /* Orbitron or Exo 2 for HUD labels, system monospace as fallback */
    font-family: 'Orbitron', 'Exo 2', 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
    @apply uppercase tracking-wider text-xs;
  }

  .font-playfair-display { font-family: var(--font-playfair-display); }
  .font-space-grotesk { font-family: var(--font-space-grotesk); }
  .font-fraunces { font-family: var(--font-fraunces); }
  .font-inter { font-family: var(--font-inter); } /* For body copy */

  .transition-m-throttle {
    @apply transition-[color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter] duration-150 ease-m-throttle;
  }
  
  .card-m-glow { /* Deep shadows, soft ambient glows, M-Sport accents */
    @apply shadow-lg transition-m-throttle;
    box-shadow: 0 12px 30px -12px hsl(var(--background)/0.9), /* Deeper base shadow */
                0 0 25px -10px hsla(var(--primary)/0.5), /* M Red ambient glow */
                0 0 20px -10px hsla(var(--bmw-m-blue)/0.4); /* M Blue ambient glow */
  }
  .card-m-glow:hover { /* Sharper, more focused "Drive-Mode Engage" glow */
    @apply shadow-[0_25px_50px_-20px_hsl(var(--background)/0.95),_0_0_35px_-8px_hsla(var(--primary)/0.8),_0_0_28px_-8px_hsla(var(--bmw-m-blue)/0.7),_0_0_40px_10px_hsla(var(--uv-blue)/0.30)_inset];
    transform: translateY(-8px); /* Card lift */
  }
  /* For text skew on card hover */
  .card-m-glow:hover .card-text-skew {
    transform: skewX(1deg);
  }


  /* M-Stripe Laser Sweep Navbar Underline */
  .nav-laser-crest {
    @apply relative text-muted-foreground hover:text-primary-foreground transition-m-throttle;
  }
  .nav-laser-crest::after {
    content: '';
    @apply absolute left-1/2 h-[3px] opacity-0 transition-all duration-200 ease-m-throttle;
    bottom: -4px;
    width: 0%;
    border-radius: 1px; /* Sharp */
    transform: translateX(-50%);
    background: linear-gradient(90deg, hsl(var(--m-light-blue-hsl)) 0%, hsl(var(--m-violet-hsl)) 33%, hsl(var(--m-red-hsl)) 66%, hsl(var(--m-light-blue-hsl)) 100%);
    background-size: 300% 100%;
    animation: navMStripeAnimation 1.2s linear infinite paused;
    box-shadow: 0 0 8px hsl(var(--m-light-blue-hsl)/0), 0 0 12px hsl(var(--m-red-hsl)/0);
  }
  .nav-laser-crest:hover::after,
  .nav-laser-crest.active-link::after {
    width: 100%;
    opacity: 1;
    animation-play-state: running;
    box-shadow: 0 0 8px hsl(var(--m-light-blue-hsl)/0.7), 0 0 12px hsl(var(--m-red-hsl)/0.7);
  }
  .nav-laser-crest.active-link {
    @apply text-primary; /* Active link text color */
    text-shadow: 0 0 8px hsl(var(--primary)/0.7); /* Redline glow for active text */
  }


  /* Carbon Texture Panel for Cards - Brutalist Grid Style */
  .carbon-texture-panel {
    background-color: hsl(var(--card)); /* Gunmetal Grey base */
    background-image: 
      linear-gradient(135deg, hsla(0,0%,0%,.12) 25%, transparent 25%), /* Darker, sharper weave */
      linear-gradient(225deg, hsla(0,0%,0%,.12) 25%, transparent 25%),
      linear-gradient(45deg, hsla(0,0%,0%,.12) 25%, transparent 25%),
      linear-gradient(315deg, hsla(0,0%,0%,.12) 25%, transparent 25%);
    background-position: 4px 0, 4px 0, 0 0, 0 0; /* Adjusted weave size */
    background-size: 8px 8px;
    background-repeat: repeat;
    border: 1px solid hsl(var(--border)); /* Graphite Grey border */
    border-radius: var(--radius); /* Knife-edge from global */
  }
  /* Thin M-Stripe border accent for cards */
  .carbon-texture-panel.m-stripe-border::before {
    content: "";
    @apply absolute top-0 left-0 w-full h-[3px] rounded-t-sm opacity-90; /* Use var(--radius) for top rounding */
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    background: linear-gradient(to right, hsl(var(--m-light-blue-hsl)), hsl(var(--m-violet-hsl)), hsl(var(--m-red-hsl)));
    box-shadow: 0 2px 5px hsla(var(--m-violet-hsl)/0.3);
  }


  /* Neon Edge Lights (Ice-White) */
  .neon-edge-white {
    box-shadow: 0 0 3px hsl(var(--foreground)), 0 0 5px hsla(var(--foreground)/0.7), 0 0 7px hsla(var(--foreground)/0.5);
  }
  .neon-edge-primary { /* M Red */
    box-shadow: 0 0 3px hsl(var(--primary)), 0 0 5px hsl(var(--primary)/0.7), 0 0 7px hsl(var(--primary)/0.5);
  }
  .neon-edge-accent { /* M Blue */
     box-shadow: 0 0 3px hsl(var(--accent)), 0 0 5px hsl(var(--accent)/0.7), 0 0 7px hsl(var(--accent)/0.5);
  }


  /* Glowing Red Seal Stamp for Mission-Log Cards */
  .card-with-glowing-seal::before {
    content: '';
    @apply absolute top-2 right-2 w-2.5 h-2.5 rounded-full bg-primary opacity-0 transition-opacity duration-300 ease-m-throttle;
    box-shadow: 0 0 8px 3px hsl(var(--primary)/0.8); /* More intense glow */
  }
  .card-with-glowing-seal:hover::before {
    opacity: 1;
  }
  
  /* Click Ripple Effect (Laser-Etched Buttons) */
  .click-ripple-effect {
    @apply relative overflow-hidden;
  }
  .click-ripple-effect::after {
    content: "";
    @apply absolute block bg-white opacity-50 rounded-full pointer-events-none;
    transform: scale(10, 10);
    opacity: 0;
    transition: transform .3s ease-out, opacity .3s ease-out;
  }
  .click-ripple-effect.rippling::after {
    transform: scale(0,0);
    opacity: 0.3;
    animation: clickRipple 0.6s linear;
  }


  /* MStartStopButton Hover Ring Enhancement (Obsidian/Jet Crystal) */
  /* Applied via MStartStopButton-base-style in globals.css, triggered by group:hover */
  .MStartStopButton-base-style::before { 
    content: '';
    position: absolute;
    inset: -2px; /* Keep small gap */
    border-radius: var(--radius); /* Sharper to match button */
    opacity: 0;
    transition: opacity 0.3s ease-in-out, box-shadow 0.3s ease-in-out; 
    background: transparent; 
    pointer-events: none; 
    z-index: -1; 
  }
  .group:hover .MStartStopButton-base-style::before { /* Triple-glow ring */
      opacity: 1;
      box-shadow: 0 0 0 1px hsl(var(--foreground)), /* Ice white inner */
                  0 0 0 3px hsl(var(--primary)),   /* M-red middle */
                  0 0 0 5px hsl(var(--bmw-m-blue)/0.7), /* M-blue outer */
                  0 0 25px 5px hsl(var(--primary)/0.7); /* Overall red glow */
  }


  /* Footer Diffuser (Apex Finish adapted for CSL) */
  .carbon-wave-animated::before { /* For footer background texture */
    content: '';
    position: absolute;
    inset: 0;
    background-image: 
      linear-gradient(45deg, hsla(var(--card), 0.05) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.05) 75%, hsla(var(--card), 0.05)),
      linear-gradient(-45deg, hsla(var(--card), 0.05) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.05) 75%, hsla(var(--card), 0.05));
    background-size: 8px 8px; /* Finer weave */
    opacity: 0.4;
    z-index: 0; 
    animation: carbonWeaveShift 8s linear infinite;
  }
  
  .footer-diffuser-fin-dot { /* Red LED dots */
    @apply w-1.5 h-1.5 rounded-full bg-primary shadow-[0_0_6px_2px_hsl(var(--primary)/0.7)];
    animation: pulseDot 2.5s infinite ease-in-out; /* Slower, more deliberate pulse */
  }

  /* Grille-Blade Section Frames (Apex Finish adapted for CSL) */
  .section-grille-blade {
    @apply absolute w-[2px] bg-gradient-to-b from-neutral-700 to-neutral-600 shadow-md; /* Thinner, darker */
  }
  
  /* Crystal HUD Tooltips (Apex Finish adapted for CSL) */
  .crystal-hud-tooltip-content {
    @apply bg-black/75 backdrop-blur-sm border-gradient-m-blue-red p-0 shadow-xl; /* Darker, less blur */
    clip-path: polygon(0% 10%, 10% 0%, 90% 0%, 100% 10%, 100% 90%, 90% 100%, 10% 100%, 0% 90%); /* Sharper shard */
  }
  .crystal-hud-tooltip-content .tooltip-inner-padding { 
     @apply p-1.5 px-2.5 text-xs text-primary-foreground; /* Smaller padding */
  }

  .border-gradient-m-blue-red { 
    border: 1px solid transparent;
    background-clip: padding-box, border-box;
    background-origin: padding-box, border-box;
    background-image: linear-gradient(to right, hsl(var(--background)), hsl(var(--background))), 
                      linear-gradient(135deg, hsl(var(--bmw-m-blue)), hsl(var(--primary)));
  }

  /* Dynamic Headlight Sweep Background (Apex Finish adapted for CSL) */
  .hero-headlight-sweep-bg {
    @apply fixed -z-10 opacity-[0.05] mix-blend-screen; /* More subtle */
    top: -30%; left: -50%; width: 200vw; height: 200vh;
    background: radial-gradient(ellipse at center, hsla(var(--accent), 0.4) 0%, transparent 60%); /* Bluer, wider */
    transform-origin: center center;
    animation: headlightSweep 18s infinite alternate ease-in-out; 
  }

  /* === NIGHTFALL ATELIER HERO STYLES (Adapted for CSL Medallion) === */
  .hero-medallion-nightfall-inner { /* Base for medallion */
    @apply relative inline-block p-0.5 rounded-full shadow-xl;
    background: radial-gradient(circle, hsl(var(--card)/0.8) 50%, transparent 75%), 
                linear-gradient(135deg, hsl(var(--border)) 0%, hsl(var(--background)) 50%, hsl(var(--border)) 100%); 
    border: 1px solid hsl(var(--border)/0.7); /* Sharper border */
  }
  .hero-medallion-nightfall-inner::before { /* M-Stripe Animated Halo */
    content: '';
    position: absolute;
    inset: -3px; /* Slightly thicker for more presence */
    border-radius: 9999px;
    z-index: -1; 
    background: var(--medallion-nightfall-gradient); /* Using CSS variable */
    animation: spin 3s linear infinite, nightfallPulseCSL 2.5s infinite ease-in-out alternate;
    filter: blur(1.5px);
  }
  .hero-headline-nightfall { /* Fraunces for main hero title */
    font-family: var(--font-fraunces); 
    @apply text-primary-foreground;
  }
  .hero-subtext-nightfall { /* Inter for hero subtext */
    font-family: var(--font-inter); 
    @apply text-muted-foreground;
  }
  /* Nano Particle Shimmer & Lens Flare (Nightfall, for background depth) */
  .nano-particle-shimmer { 
    @apply absolute inset-0 overflow-hidden pointer-events-none -z-[5]; /* Behind hero content */
  }
  .nano-particle {
    @apply absolute rounded-full bg-accent opacity-0;
    animation: nanoDrift 8s infinite ease-in-out;
  }
  .vertical-lens-flare {
    @apply absolute top-0 h-full w-12 mix-blend-screen pointer-events-none opacity-15; /* More subtle */
    background: linear-gradient(to bottom, transparent, hsla(var(--accent), 0.25), transparent);
    animation: flareShift 10s infinite alternate ease-in-out;
  }


  /* === EMPIRE EDITION HERO STYLES (Adapted for CSL Medallion) === */
  .hero-medallion-empire { /* Base for medallion if different style is preferred */
    @apply relative inline-block p-0.5 rounded-full shadow-xl hover:scale-105 transition-transform duration-300 ease-m-throttle;
    background: radial-gradient(circle, hsl(var(--card)) 50%, transparent 75%), 
                linear-gradient(135deg, hsl(var(--border)) 0%, hsl(var(--background)) 50%, hsl(var(--border)) 100%); 
    border: 1px solid transparent; /* Sharper border */
  }
  .hero-medallion-empire::before { /* Gold glint/M-stripe pulse */
    content: '';
    @apply absolute inset-[-3px] rounded-full -z-10; /* Slightly thicker for more presence */
    background: transparent; 
    animation: empireMedallionPulse 2.5s infinite linear; 
    box-shadow: 0 0 15px 1px hsla(var(--uv-blue),.3), 0 0 8px 0 hsla(var(--primary)/.2) inset; 
  }
  .hero-medallion-empire:hover::after { /* Gold glint sweep */
    content: '';
    @apply absolute inset-0 rounded-full opacity-0;
    background: linear-gradient(45deg, transparent 30%, hsla(var(--empire-gold-hsl),0.3) 50%, transparent 70%);
    animation: goldGlintSweep 1.2s linear forwards; 
  }
  .hero-medallion-empire .spec-highlight-arc { /* Lacquer highlight */
    @apply absolute inset-0 rounded-full;
    background: linear-gradient(135deg, rgba(255,255,255,.1) 0%, transparent 65%); /* More subtle */
  }
  .hero-headline-empire { 
    font-family: var(--font-fraunces); /* Changed to Fraunces */
    @apply text-[#E5E5E5]; 
    text-shadow: var(--empire-text-shadow); /* Using CSS variable */
  }
  .hero-tagline-empire { 
    font-family: var(--font-inter); /* Changed to Inter */
    @apply text-transparent bg-clip-text bg-gradient-to-r from-[hsl(var(--bmw-m-blue))] to-[hsl(var(--primary))] relative;
  }
  .hero-tagline-empire::after { /* Grille-blade underline */
    content: '';
    @apply absolute left-0 -bottom-0.5 h-[2px] bg-gradient-to-r from-[hsl(var(--bmw-m-blue))] to-[hsl(var(--primary))];
    width: 0%; 
    border-radius: 9999px;
    transition: width 0.5s var(--ease-m-throttle); 
  }
  .hero-tagline-empire.underline-visible::after {
    width: 110%; /* Slight overshoot */
  }
  .hero-empire-bg { /* Background for this hero variant */
    @apply relative overflow-hidden; 
    background-image: 
      radial-gradient(ellipse at 50% 10%, hsla(var(--empire-i-blue-fog-start-hsl), 0.2) 0%, transparent 65%), 
      linear-gradient(45deg, hsla(var(--card), 0.015) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.015) 75%, hsla(var(--card), 0.015)), 
      linear-gradient(-45deg, hsla(var(--card), 0.015) 25%, transparent 25%, transparent 75%, hsla(var(--card), 0.015) 75%, hsla(var(--card), 0.015)),
      radial-gradient(circle at 30% 30%, #1a1a1c 0%, hsl(var(--background)) 70%); 
    background-size: cover, 6px 6px, 6px 6px, cover; /* Finer carbon */
  }
  /* Halo glows & Gantry lights (Empire, refined) */
  .halo-glow { 
    @apply absolute rounded-full mix-blend-soft-light pointer-events-none -z-[5];
    animation: bloomGlide 15s infinite alternate ease-in-out;
  }
  .hero-bloom-extra { /* More subtle bloom */
    @apply absolute -z-[6];
    width: 500px; height: 500px; top: 45%; left: 45%;
    background: radial-gradient(circle, hsla(var(--m-violet-hsl), 0.08) 0%, transparent 70%);
    animation: bloomGlide 18s infinite alternate ease-in-out 1.5s;
  }
  .hero-empire-tachometer { /* Apex Meter / RPM Bar Styling */
    @apply fixed bottom-4 right-4 w-20 h-10 rounded-sm p-0.5 overflow-hidden; /* Sharper */
    background: linear-gradient(135deg, hsl(var(--card) / 0.8), hsl(var(--background) / 0.8));
    backdrop-filter: blur(6px); /* Less blur */
    border: 1px solid hsl(var(--border) / 0.6);
    box-shadow: 0 0 12px hsl(var(--accent)/0.25), inset 0 0.5px 1px hsl(var(--foreground)/0.08);
  }
  .hero-empire-tachometer-bar { /* Gradient for RPM bar */
    @apply h-full rounded-sm transition-all duration-300 ease-linear;
  }
  .hero-empire-tachometer::before { /* Inner gloss for RPM bar */
    content: '';
    @apply absolute top-0 left-0 h-full w-full rounded-sm opacity-20 blur-sm;
    background: inherit; 
  }
   .hero-empire-tachometer-trail { /* Ghost trail for RPM */
    @apply absolute top-0 left-0 h-full w-full rounded-sm opacity-0 blur-sm transition-opacity duration-500;
    background: inherit;
  }
  .hero-gantry-light { /* Section divider lights */
    @apply absolute left-0 w-full h-[2px] opacity-0; /* Thinner */
    background: linear-gradient(90deg, transparent, hsl(var(--accent)/0.6) 50%, transparent);
    box-shadow: 0 0 6px 0.5px hsl(var(--accent)/0.4); /* Less intense */
  }
  
  /* === RPM WIDGET (Bottom-right small dial - M|Nightfall Continuum) === */
  .rpm-widget-dial {
    @apply relative w-16 h-16 rounded-full bg-neutral-800/80 backdrop-blur-sm border-2 border-neutral-700/70 shadow-inner; /* Smaller, more subtle */
  }
  .rpm-widget-center {
    @apply absolute top-1/2 left-1/2 w-2.5 h-2.5 bg-primary rounded-full -translate-x-1/2 -translate-y-1/2 z-10 shadow-md;
  }
  .rpm-widget-needle {
    @apply absolute top-1/2 left-1/2 w-[3px] h-6 bg-primary-foreground rounded-t-full origin-bottom transform -translate-y-full shadow-sm; /* Thinner */
  }

  /* === CONTENT BURST SECTION CARDS (M|Nightfall Continuum) === */
  .carbon-card-burst { 
    @apply bg-neutral-800/80 backdrop-blur-sm border border-neutral-700/70 rounded-md shadow-xl relative overflow-hidden transition-all duration-300 ease-m-throttle;
    border-radius: var(--radius); /* Knife-edge */
  }
  .carbon-card-burst:hover {
    transform: translateY(-8px); /* Increased lift for "Drive-Mode Engage" */
    box-shadow: 0 12px 25px hsl(var(--primary)/0.4), 0 0 18px hsl(var(--accent)/0.3); /* Twin-shadow neon glow */
  }
  .carbon-card-burst::before { /* M-stripe border accent */
    content: "";
    @apply absolute top-0 left-0 w-full h-1 rounded-t-sm opacity-85;
    background: linear-gradient(to right, hsl(var(--bmw-m-blue)), hsl(var(--m-violet-hsl)), hsl(var(--primary)));
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
  }
  .gantry-light-sweep-burst { /* Section teaser light */
    @apply absolute top-0 left-0 w-full h-1 opacity-0;
    background: linear-gradient(90deg, transparent, hsl(var(--accent)/0.6) 50%, transparent);
    box-shadow: 0 0 6px 0.5px hsl(var(--accent)/0.4);
    animation: gantrySweepAnimation 0.7s ease-out forwards;
  }


  /* === SENTIENT CONSOLE & HUD STYLES (Aggressive Elegance / CSL Theme) === */
  .hud-console-panel {
    @apply fixed bottom-4 left-4 p-2.5 md:p-3 rounded-md shadow-2xl text-xs backdrop-blur-md border border-neutral-700/60; /* Sharper radius */
    background-color: hsla(var(--background), 0.9); /* Adjusted alpha for current CSL palette */
    color: hsl(var(--foreground)); 
    font-family: var(--font-monospace-subheader); 
    width: 260px; /* Slightly smaller */
    max-height: 260px; 
    display: flex;
    flex-direction: column;
    gap: 2px; 
    box-shadow: 0 0 20px hsl(var(--uv-blue)/0.35), 0 0 8px hsl(var(--uv-blue)/0.15) inset; /* Refined UV glow */
    transition: box-shadow 0.3s var(--ease-m-throttle);
    border-radius: var(--radius);
  }
  .hud-console-panel.uv-glow { /* Active Ghostline glow */
    box-shadow: 0 0 30px 6px hsl(var(--uv-blue)/0.6), 0 0 15px 4px hsl(var(--uv-blue)/0.3) inset, 0 0 8px 2px hsl(var(--primary)/0.3);
  }
  .hud-console-header {
    @apply flex justify-between items-center pb-0.5 mb-0.5 border-b border-neutral-700/80; /* Thinner border */
  }
  .hud-console-title {
    @apply text-xs font-bold uppercase tracking-wider text-primary-foreground font-heading; /* Smaller title */
  }
  .hud-console-settings-icon {
    @apply text-neutral-400 hover:text-primary transition-m-throttle;
    animation: spin 3s linear infinite; /* Direct CSS for spin-slow */
  }
  .hud-console-log { 
    @apply flex-grow overflow-y-auto text-[10px] leading-tight p-0.5 bg-black/30 rounded-sm min-h-[40px]; /* Tighter log */
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary)) hsl(var(--neutral-800));
  }
  .hud-console-log .console-log-line { @apply mb-0.5; } /* Tighter lines */
  .hud-console-log .console-log-line.input::before { content: '> SYS_CMD: '; @apply text-accent; } 
  .hud-console-log .console-log-line.output { @apply text-green-500; } /* Brighter green */
  .hud-console-log .console-log-line.error { @apply text-red-500; } /* Brighter red */
  .hud-console-log .console-log-line.info { @apply text-sky-400; } /* Brighter blue */
  .hud-console-log .console-log-line.system { @apply text-purple-400 italic; } 
  .hud-console-log .typewriter-cursor {
    @apply inline-block bg-primary w-1.5 h-2.5 ml-0.5 animate-pulse; /* Thinner cursor */
  }
  .hud-gauge-item {
    @apply flex justify-between items-center text-[10px] py-0; /* Tighter gauge items */
  }
  .hud-gauge-label { 
    @apply flex items-center gap-1 text-neutral-400 uppercase tracking-wider font-monospace-subheader; 
  }
  .hud-gauge-label svg { @apply w-2.5 h-2.5 text-accent; } /* Smaller icons */
  .hud-gauge-value {
    @apply font-mono text-neutral-300 font-medium;
  }
  .hud-meter-track {
    @apply h-1 w-full bg-neutral-700/70 rounded-full overflow-hidden my-0.5; /* Thinner meter */
  }
  .hud-meter-fill { 
    @apply h-full rounded-full transition-all duration-300 ease-linear;
    box-shadow: inset 0 0 2px hsl(var(--background)/0.6); /* Sharper inset */
  }
  .hud-console-button-container {
    @apply grid grid-cols-2 gap-1 pt-0.5 mt-0.5 border-t border-neutral-700/80; /* Tighter button grid */
  }
  .hud-console-button { 
    @apply !w-full !h-7 !text-[9px] !tracking-normal !border-neutral-600/80; /* Smaller buttons */
  }
  .hud-console-button.active-toggle { 
    @apply !bg-gradient-to-r !from-accent !to-sky-500 !text-primary-foreground !border-accent/80 shadow-[0_0_6px_hsl(var(--accent)/0.4)]; /* Refined active glow */
  }
  .form-container-halo { 
    transition: box-shadow 0.4s var(--ease-m-throttle);
  }
  .form-container-halo-active { 
    box-shadow: 0 0 20px 4px hsl(var(--primary)/0.45), 0 0 8px 1px hsl(var(--primary)/0.25); /* Refined form halo */
  }
  
  /* === SKILL SECTION (Overclocked Skill Flux Engine - CSL Theme) === */
  .skill-card-trail-container { 
    @apply relative; 
  }
  .skill-card-trail { /* Motion blur streak */
    @apply absolute inset-0 -z-10 rounded-lg opacity-0 transition-opacity duration-300;
    background: radial-gradient(circle at center, hsl(var(--primary)/0.25) 0%, transparent 75%); /* More subtle base trail */
    transform: scale(1.15); 
    filter: blur(6px);
  }
  .skill-card-trail-container:hover .skill-card-trail {
    opacity: 1;
    animation: skillTrailFadeOut 0.5s 0.2s forwards; 
  }
  .skill-card-trail.electric-trail { /* Overclocked mode trail */
    background: radial-gradient(circle at center, hsl(var(--uv-blue)/0.4) 0%, transparent 65%),
                radial-gradient(circle at center, hsl(var(--primary)/0.25) 0%, transparent 75%);
    filter: blur(4px) brightness(1.4); /* Sharper, brighter */
    animation: skillFluxPulse 0.6s infinite alternate;
  }
  .skill-overclocked { /* Pulsing/flickering for repeatedly hovered skills */
    animation: skillFluxPulse 0.7s infinite ease-in-out, skillJitter 0.1s infinite alternate ease-in-out; /* Faster jitter */
    border-color: hsl(var(--uv-blue)/0.8) !important; /* Brighter border */
    box-shadow: 0 0 12px hsl(var(--uv-blue)/0.5), 0 0 6px hsl(var(--primary)/0.35); /* Refined glow */
  }
  .animate-skill-jitter { /* Applied on hover for general skill cards */
    animation: skillJitter 0.25s infinite alternate ease-in-out; /* Faster general jitter */
  }

  /* === NEURAL DRIFT TIMELINE STYLES (XENOFRAME adapted for CSL) === */
  .neural-drift-timeline-container {
    @apply relative w-full py-3; /* Tighter padding */
  }
  .neural-drift-timeline {
    @apply flex overflow-x-auto py-3 px-1.5 space-x-6 relative; /* Tighter padding/spacing */
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary)) hsl(var(--background));
  }
  .neural-drift-timeline::before { 
    content: '';
    @apply absolute left-0 top-1/2 h-[1.5px] w-full bg-neutral-700/80 -translate-y-1/2 -z-10; /* Thinner line */
  }
  .timeline-milestone {
    @apply relative flex-shrink-0 w-64 bg-card/85 p-3 rounded-md shadow-lg border border-border/60 text-center transition-all duration-300 hover:scale-105 hover:shadow-primary/35; /* Smaller card, sharper radius */
    border-radius: var(--radius);
  }
  .timeline-milestone-node { 
    @apply absolute -top-1 left-1/2 w-3 h-3 bg-primary rounded-full -translate-x-1/2 transform border-2 border-background shadow-md; /* Smaller node */
  }
  .timeline-milestone-current .timeline-milestone-node {
    box-shadow: 0 0 10px hsl(var(--primary)/0.7); /* Refined pulse shadow */
    animation: pulseDot 2s infinite ease-in-out;
  }
  .timeline-milestone-icon { 
    @apply absolute -left-2.5 -top-2.5 p-1.5 bg-accent rounded-full shadow-lg border-2 border-background; /* Smaller icon container */
  }

  /* === USER INTERACTION CONTEXT FEEDBACK STYLES (XENOFRAME) === */
  .rare-section-pulse-active body { 
    animation: rareSectionVisualPulse 0.5s ease-out forwards;
  }
  .hyperactive-scroll-feedback body { 
    animation: hyperScrollVisualFeedback 0.3s ease-out forwards;
  }
  .skill-card-ghostline-active { 
    animation: ghostlineSkillPulse 2s infinite ease-in-out;
    border-color: hsl(var(--uv-blue)/0.8) !important;
  }
  .erratic-glow { 
    animation: erraticGlowAnimation 0.8s infinite ease-in-out;
  }

  /* === SCROLL MOMENTUM BAR / APEX METER (CSL Theme) === */
  .m-chrono-scroll-gauge-container { /* Apex Meter */
    @apply fixed top-3 left-3 h-7 w-44 bg-neutral-900/75 backdrop-blur-sm rounded-sm overflow-hidden shadow-lg border border-neutral-700/60; /* Smaller, sharper */
    clip-path: polygon(0 0, 100% 0, 100% 100%, 50% 80%, 0 100%); /* Sharper apex */
    box-shadow: 0 0 12px 1.5px hsl(var(--uv-blue)/0.35), inset 0 0.5px 0.5px hsl(var(--foreground)/0.05), 0 0 4px hsl(var(--background)/0.25) inset;
    border-radius: var(--radius);
  }
  .m-rpm-gauge-fill { /* Base fill style for the bar */
    @apply h-full transition-all duration-100 ease-linear rounded-sm;
    box-shadow: inset 0 0 6px hsl(var(--background)/0.6), 0 0 8px hsl(var(--primary)/0.5); 
  }
  .m-rpm-gauge-fill-xenoflame { /* Specific gradient for Apex Meter (iBlue -> Hyper Violet -> Voltage Gold) */
    background-image: linear-gradient(to right, hsl(var(--bmw-m-blue)) 0%, hsl(var(--m-violet-hsl)) 50%, hsl(var(--primary)) 100%); /* Adjusted gold to primary red for CSL */
    box-shadow: inset 0 0 4px hsla(0,0%,0%,0.6), 0 0 6px hsl(var(--m-violet-hsl)/0.6), 0 0 12px hsl(var(--primary)/0.4);
  }
  .m-chrono-tick-container {
    @apply absolute inset-0 flex justify-between px-0.5 items-center pointer-events-none; /* Tighter ticks */
  }
  .m-rpm-tick-major, .m-rpm-tick-minor, .m-rpm-tick-redzone {
    @apply h-2/3 opacity-70 transition-opacity duration-300; 
    box-shadow: 0 0 2px hsl(var(--foreground)/0.6), 0 0 0.5px hsl(var(--foreground)/0.8); /* Sharper ticks */
  }
  .m-rpm-tick-major { width: 1.5px; background-color: hsl(var(--foreground)/0.8); } /* Thinner major */
  .m-rpm-tick-minor { width: 0.5px; background-color: hsl(var(--foreground)/0.5); } /* Thinner minor */
  .m-rpm-tick-redzone { 
    background-color: hsl(var(--primary)/0.8) !important; 
    box-shadow: 0 0 4px hsl(var(--primary)/0.7), 0 0 1.5px hsl(var(--primary)/0.9); 
  }
  .m-rpm-tick-active { opacity: 0.9; transform: scaleY(1.1); } 
  .chrono-gauge-redline .m-rpm-gauge-fill { 
    animation: m-rpm-redline-led-pulse 0.1s infinite alternate ease-in-out; 
  }

  /* === NEUROLINK TERMINAL STYLES (XENOFRAME adapted for CSL) === */
  .neurolink-terminal-overlay {
    @apply fixed inset-0 bg-black/85 backdrop-blur-sm z-[200] flex items-center justify-center p-3; /* Darker overlay */
    animation: fadeIn 0.3s ease-out;
  }
  .neurolink-terminal {
    @apply bg-neutral-900/95 border border-primary/40 rounded-md shadow-2xl w-full max-w-xl h-[65vh] flex flex-col overflow-hidden; /* Sharper, slightly smaller */
    box-shadow: 0 0 25px hsl(var(--primary)/0.35);
    animation: slideInFromBottom 0.4s ease-out;
    border-radius: var(--radius);
  }
  .neurolink-terminal-header {
    @apply p-1.5 bg-neutral-800/90 border-b border-primary/40 text-xs text-primary font-mono flex justify-between items-center; /* Tighter header */
  }
  .neurolink-terminal-output {
    @apply flex-grow p-2 overflow-y-auto font-mono text-xs; /* Smaller text */
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary)) hsl(var(--neutral-800));
  }
  .neurolink-terminal-output div { @apply mb-0.5 whitespace-pre-wrap break-words; } /* Tighter lines */
  .neurolink-terminal-output .input-line::before { content: 'M_DRIVE:> '; @apply text-accent; } /* Themed prompt */
  .neurolink-terminal-output .output-line { @apply text-green-400; }
  .neurolink-terminal-output .error-line { @apply text-red-400; }
  .neurolink-terminal-output .info-line { @apply text-sky-400; }
  .neurolink-terminal-input-area {
    @apply p-1.5 border-t border-primary/40 flex items-center bg-neutral-800/90; /* Tighter input area */
  }
  .neurolink-terminal-prompt { @apply text-accent font-mono text-xs mr-1.5; }
  .neurolink-terminal-input {
    @apply flex-grow bg-transparent border-none outline-none text-primary-foreground font-mono text-xs p-0.5; /* Smaller input text */
    text-shadow: 0 0 4px hsl(var(--primary)/0.4);
  }

  /* General Dialog Content Fix */
  .DialogContent[data-state="open"] {
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }


  /* Keyframes (Consolidated, updated, and new for CSL) */
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes slideInFromBottom { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } } /* Shallower slide */

  @keyframes spin { to { transform: rotate(360deg); } }
  @keyframes nightfallPulseCSL { /* Refined M-stripe halo pulse for medallion */
    0% { filter: blur(1.5px) brightness(0.9); opacity: 0.7; }
    50% { filter: blur(2.5px) brightness(1.2); opacity: 1; }
    100% { filter: blur(1.5px) brightness(0.9); opacity: 0.7; }
  }
  
  @keyframes m-rpm-redline-led-pulse { /* Sharper, more aggressive redline pulse */
    0%, 100% {
      box-shadow: inset 0 0 10px hsl(var(--background)/0.6), 0 0 30px 10px hsl(var(--primary)/1), 0 0 60px 18px hsl(var(--primary)/0.8);
      filter: brightness(3.5) saturate(3.5); /* Increased intensity */
    }
    50% {
      box-shadow: inset 0 0 15px hsl(var(--background)/0.7), 0 0 45px 15px hsl(var(--primary)/1), 0 0 90px 30px hsl(var(--primary)/0.95);
      filter: brightness(4.5) saturate(4.5); /* Max intensity */
    }
  }

  @keyframes carbonWeaveShift { 
    0% { background-position: 0 0; }
    100% { background-position: 10px 10px; } /* Smaller shift for finer weave */
  }
  @keyframes pulseDot { 
    0%, 100% { opacity: 0.6; transform: scale(0.9); box-shadow: 0 0 4px hsl(var(--primary)/0.5); }
    50% { opacity: 1; transform: scale(1.1); box-shadow: 0 0 8px hsl(var(--primary)); }
  }

  /* Nav M-Stripe Animation */
  @keyframes navMStripeAnimation {
    0% { background-position: 200% 0; } /* Start off-screen right */
    100% { background-position: -100% 0; } /* Sweep to off-screen left */
  }

  /* Skill Flux Animations */
  @keyframes skillFluxPulse { /* For overclocked skills */
    0%, 100% { border-color: hsl(var(--uv-blue)/0.5); box-shadow: 0 0 8px hsl(var(--uv-blue)/0.3), 0 0 4px hsl(var(--primary)/0.2); }
    50% { border-color: hsl(var(--uv-blue)); box-shadow: 0 0 20px hsl(var(--uv-blue)/0.7), 0 0 10px hsl(var(--primary)/0.4), inset 0 0 4px hsl(var(--uv-blue)/0.3); }
  }
  @keyframes skillJitter { /* For overclocked skills & general hover */
    0% { transform: translate(0, 0) rotate(0); }
    25% { transform: translate(0.5px, -0.5px) rotate(0.1deg); } /* More subtle jitter */
    50% { transform: translate(-0.5px, 0.5px) rotate(-0.1deg); }
    75% { transform: translate(0.5px, 0.5px) rotate(0.05deg); }
    100% { transform: translate(0, 0) rotate(0); }
  }
  @keyframes skillTrailFadeOut { /* For skill card hover trail */
    from { opacity: 1; transform: scale(1.15); }
    to { opacity: 0; transform: scale(1.3); filter: blur(10px); }
  }
  
  /* Click Ripple Animation */
  @keyframes clickRipple {
    to {
      transform: scale(4);
      opacity: 0;
    }
  }

  /* Headlight Sweep (Hero Background) */
  @keyframes headlightSweep {
    0% { transform: translateX(-6vw) rotate(-15deg); }
    100% { transform: translateX(6vw) rotate(-15deg); }
  }
  
  /* Gantry Light Sweep (Section Teasers / Hero Dividers) */
  @keyframes gantrySweepAnimation {
    0% { transform: translateX(-100%); opacity: 0.5; }
    50% { transform: translateX(0); opacity: 1; }
    100% { transform: translateX(100%); opacity: 0.5; }
  }

  /* Bloom Glide (Hero Background Halos) */
  @keyframes bloomGlide {
    0% { transform: translate(0, 0) scale(1); opacity: 0.08; } /* More subtle start */
    50% { transform: translate(15px, 10px) scale(1.1); opacity: 0.12; }
    100% { transform: translate(0, 0) scale(1); opacity: 0.08; }
  }

  /* Gold Glint Sweep (Medallion Hover) */
  @keyframes goldGlintSweep {
    0% { opacity: 0; background-position: 200% 50%; }
    50% { opacity: 0.3; }
    100% { opacity: 0; background-position: -100% 50%; }
  }
  
  /* Rare Section Pulse (Body visual feedback) */
  @keyframes rareSectionVisualPulse {
    0% { box-shadow: inset 0 0 0 0px hsl(var(--primary)/0); }
    50% { box-shadow: inset 0 0 0 5px hsl(var(--primary)/0.2); }
    100% { box-shadow: inset 0 0 0 0px hsl(var(--primary)/0); }
  }
  /* Hyper Scroll Feedback (Body visual feedback) */
  @keyframes hyperScrollVisualFeedback {
    0% { filter: brightness(1); }
    50% { filter: brightness(0.9) saturate(1.5); } /* Darken and saturate */
    100% { filter: brightness(1); }
  }
  /* Ghostline Skill Pulse (Feedback) */
  @keyframes ghostlineSkillPulse {
    0%, 100% { border-color: hsl(var(--uv-blue)/0.8); }
    50% { border-color: hsl(var(--uv-blue)/0.4); }
  }
  /* Erratic Glow (Feedback) */
  @keyframes erraticGlowAnimation {
    0% { box-shadow: 0 0 10px hsl(var(--primary)/0.4), 0 0 5px hsl(var(--accent)/0.2); }
    25% { box-shadow: 0 0 15px hsl(var(--primary)/0.6), 0 0 8px hsl(var(--accent)/0.3), 0 0 5px hsl(var(--uv-blue)/0.2); }
    50% { box-shadow: 0 0 8px hsl(var(--primary)/0.3), 0 0 3px hsl(var(--accent)/0.1); }
    75% { box-shadow: 0 0 18px hsl(var(--primary)/0.7), 0 0 10px hsl(var(--accent)/0.4), 0 0 8px hsl(var(--uv-blue)/0.3); }
    100% { box-shadow: 0 0 10px hsl(var(--primary)/0.4), 0 0 5px hsl(var(--accent)/0.2); }
  }

}

/* Reduced Motion Fallbacks (CSL Theme) */
@media (prefers-reduced-motion: reduce) {
  .transition-m-throttle {
    transition: none !important;
  }
  .nav-laser-crest::after { 
    animation: none !important;
    width: 70% !important; /* Static underline width */
    opacity: 1 !important;
    background: linear-gradient(90deg, hsl(var(--m-light-blue-hsl)) 0%, hsl(var(--m-violet-hsl)) 50%, hsl(var(--m-red-hsl)) 100%);
    background-size: 100% 100%;
    background-position: center;
  }
  .hud-console-settings-icon { animation: none; } 
  .carbon-wave-animated::before { animation: none !important; } 
  .footer-diffuser-fin-dot { animation: none !important; opacity: 0.7; } 
  .hero-headlight-sweep-bg { animation: none !important; opacity: 0.05 !important; } 
  .chrono-gauge-redline .m-rpm-gauge-fill { animation: none !important; background: hsl(var(--primary)) !important; } 
  .m-rpm-tick-active { transform: scaleY(1); } 
  .halo-glow { animation: none; opacity: 0.1; }  
  .hero-gantry-light { animation: none; opacity: 0.5; } 
  .hero-medallion-empire::before {animation: none; box-shadow: 0 0 10px 1px hsla(var(--uv-blue),.2), 0 0 5px 0 hsla(var(--primary)/.15) inset;} 
  .hero-medallion-empire:hover::after { animation: none; opacity: 0.3; background-position: center; } 
  .hero-tagline-empire.underline-visible::after { transition: none; width: 100%;} 
  .hero-medallion-nightfall-inner::before { animation: none !important; opacity: 0.7; filter: blur(1px); }
  .vertical-lens-flare { animation: none; opacity: 0.15; } 
  .nano-particle { animation: none; opacity: 0.05; } /* Show a few static particles */
  .skill-card-trail-container:hover .skill-card-trail { animation: none; opacity: 0.4; } 
  .skill-overclocked { animation: none !important; border-color: hsl(var(--uv-blue)/0.7) !important; box-shadow: 0 0 12px hsl(var(--uv-blue)/0.5), 0 0 6px hsl(var(--primary)/0.3); }
  .animate-skill-jitter { animation: none; }
  .rare-section-pulse-active body { animation: none; } 
  .hyperactive-scroll-feedback body { animation: none; } 
  .erratic-glow { animation: none; } 
  .neurolink-terminal-overlay { animation: none; } 
  .neurolink-terminal { animation: none; }
  .MStartStopButton-base-style::before { animation: none !important; }
  .group:hover .MStartStopButton-base-style::before { animation: none !important; box-shadow: 0 0 0 1px hsl(var(--background)), 0 0 0 3px hsl(var(--primary)), 0 0 0 5px hsl(var(--bmw-m-blue)/0.7), 0 0 15px 5px hsl(var(--primary)/0.6); }
  .animate-cameraShutterFlash { animation: none !important; }
  .click-ripple-effect.rippling::after { animation: none; display: none; }
  .gantry-light-sweep-burst { animation: none; opacity: 0.7; transform: translateX(0); }
}

